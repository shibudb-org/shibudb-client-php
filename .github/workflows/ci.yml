name: CI Tests

on:
  push:
    branches: [ main, master, develop ]
  pull_request:
    branches: [ main, master, develop ]
  workflow_dispatch:

jobs:
  # Standalone tests that don't require ShibuDb server
  standalone-tests:
    name: Standalone Tests (PHP ${{ matrix.php-version }})
    runs-on: ubuntu-latest
    strategy:
      fail-fast: false
      matrix:
        php-version:
          - '5.6'
          - '7.0'
          - '7.4'
          - '8.0'
          - '8.1'
          - '8.2'
          - '8.3'
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      
      - name: Setup PHP
        uses: shivammathur/setup-php@v2
        with:
          php-version: ${{ matrix.php-version }}
          tools: composer
          coverage: none
      
      - name: Validate PHP syntax
        run: |
          php -l ShibuDbClient.php
          php -l simple_test.php
          php -l example.php
          php -l pool_test.php
          php -l comprehensive_pool_test.php
          php -l json_parsing_test.php
          php -l special_chars_test.php
      
      - name: Run JSON Parsing Tests
        run: php json_parsing_test.php
      
      - name: Run Special Characters Tests
        run: php special_chars_test.php
